!function(e){e.fn.durationinput=function(t){function r(){c=0,o=[],d.resultInput&&d.resultInput.val(""),d.inputSuccessClass&&l.removeClass(d.inputSuccessClass),d.inputErrorClass&&l.removeClass(d.inputErrorClass)}function s(t){r();var t=e.trim(t);if(t=t.replace(/\s{2,}/g," "),0!=t.length){if(t){t=t.toLowerCase(),t=t.replace(",",".");var s,h,p=[],x={value:"",period:""},m=t.split(""),T=m.length,f=!1;if(d.periodDefault&&null!=t.match(/^[0-9.]+$/))x={value:t,period:d.periodDefault},p.push(x);else{for(var v=0;T>v;v++)s=m[v],null!=s.match(/^[0-9.]+$/)?(f&&(p.push(x),x={value:"",period:""},f=!1),x.value+=""+s):null!=s.match(/^[a-z]+$/i)&&(x.period+=""+s,f=!0);f&&x.value&&p.push(x)}if(p.length>0)for(var S,b,M,g=0;g<p.length;g++)switch(S=p[g].value,b=p[g].period,M=!1,S||b?S?b||u(d.errorTextNoPeriod.replace("$0",S)):u(d.errorTextNoValue.replace("$0",b)):u(d.errorTextNoValueNoPeriod),b){case"m":case"mi":case"min":case"minu":case"minute":case"minutes":case"minuten":if(-1!==e.inArray("min",d.periods)){d.minSteps&&(S=i(S,d.minSteps)),S>0&&(c+=S);break}case"h":case"ho":case"hou":case"hour":case"hours":case"hr":case"s":case"st":case"stu":case"stund":case"stunde":case"stunden":if(-1!==e.inArray("h",d.periods)){d.hSteps&&(S=i(S,d.hSteps)),S>0&&(M=60*S,d.minSteps&&(M=i(M,d.minSteps)),c+=M);break}case"d":case"da":case"day":case"days":case"t":case"ta":case"tag":case"tage":if(-1!==e.inArray("d",d.periods)){d.dSteps&&(S=i(S,d.dSteps)),S>0&&(M=S*d.dHours*60,d.minSteps&&(M=i(M,d.minSteps)),c+=M);break}default:u(d.errorTextPeriodNotValid.replace("$0",b))}else u(d.errorTextInvalid)}if(d.max){var S=d.max.match(/[0-9]+/g),b=d.max.match(/[a-z]+/g);S&&b&&(S=1*S,minMax=0,"min"==b?minMax=S:"h"==b?minMax=60*S:"d"==b&&(minMax=S*d.dHours*60),minMax&&c>minMax&&(h=d.errorTextMinMax,h=h.replace("$0",a(c," und ")),h=h.replace("$1",a(minMax," und ",b)),u(h)))}0==o.length?d.resultInput&&d.resultInput.val(c):c=!1,n(c),d.afterCalculation&&d.afterCalculation(l,c)}}function u(e){o.push(e)}function n(e){d.resultTextSuccessObj&&d.resultTextSuccessObj.html(""),d.resultTextErrorObj&&d.resultTextErrorObj.html(""),o.length>0?(l.addClass(d.inputErrorClass),d.resultTextErrorObj&&d.resultTextErrorObj.append('<div class="'+d.resultErrorClass+'">'+o.join("<br>")+"</div>")):e!==!1&&(l.addClass(d.inputSuccessClass),d.overwriteInputValue&&l.val(a(e)),d.resultTextSuccessObj&&d.resultTextSuccessObj.html('<div class="'+d.resultSuccessClass+'">'+a(e)+"</div>")),d.resultTextSuccessObj&&0==d.resultTextSuccessObj.html().length&&d.resultTextSuccessObj.html(d.resultDefaultText)}function a(e,t,r){var s,u;void 0==t&&(t=" "),void 0!=r&&r||(r=d.periodResult),e>59&&"min"!=r&&(s=Math.floor(e/60),e-=60*s,s>d.dHours-1&&"h"!=r&&(u=Math.floor(s/d.dHours),s-=u*d.dHours));var n=[];if(u>0&&n.push(1==u?u+" "+d.dText:u+" "+d.dTextMulti),s>0&&n.push(1==s?s+" "+d.hText:s+" "+d.hTextMulti),(e>0||0==e&&!s&&!u)&&n.push(1==e?e+" "+d.minText:e+" "+d.minTextMulti),0==n.length)return!1;var a=n.join(t);return a}function i(e,t){return e=parseInt(e),Math.ceil(e/t)*t}var l=e(this),o=[],c=0,d=e.extend({delay:700,overwriteInputValue:!0,resultInput:e(this).next(":hidden"),resultTextSuccessObj:e(this),resultTextErrorObj:!1,periods:["d","h","min"],periodDefault:"min",periodResult:null,afterCalculation:null,max:null,minSteps:1,hSteps:0,dSteps:0,dHours:24,minText:"min",minTextMulti:"min",hText:"h",hTextMulti:"h",dText:"T",dTextMulti:"T",resultSuccessClass:"c-green",resultErrorClass:"c-red",inputSuccessClass:"success",inputErrorClass:"error",errorTextInvalid:"Der Zeitwert konnte nicht erkannt werden.",errorTextNoValueNoPeriod:"Kein Wert und Zeiteinheit gefunden.",errorTextNoValue:"Keinen Wert zur Zeiteinheit ($0) gefunden.",errorTextNoPeriod:"Keine Zeiteinheit zum Wert ($0) gefunden.",errorTextPeriodNotValid:"Zeiteinheit ($0) ungültig.",errorTextMinMax:"Die Dauer $0 überschreitet den maximalen Wert von $1.",resultDefaultText:""},t);if(d.resultTextSuccessObj&&d.resultTextSuccessObj.html().length>0&&(d.resultDefaultText=d.resultTextSuccessObj.html()),d.resultInput){var h=d.resultInput.val();h&&n(h)}l.keyup(function(){var t=e(this);p(function(){s(t.val())},d.delay)});var p=function(){var e=0;return function(t,r){clearTimeout(e),e=setTimeout(t,r)}}();return e.fn.showResult=function(e){return n(e)},e.fn.formatMinutes=function(e){return a(e)},this}}(jQuery);